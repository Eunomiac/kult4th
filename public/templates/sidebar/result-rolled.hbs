{{dbLog "{CHAT} result-rolled.hbs" this}}

<div class="kult4th-chat {{cssClass}}">

	<div class="roll-intro-header">
		<span class="roll-char-name">{{rollerName}}</span>
		<span class="roll-intro-line">
      {{#if sourceName}}
        {{{localize "kult4th.roll.rollAttrTo" attrName=(case "title" attribute)}}}
      {{else}}
        {{{localize "kult4th.roll.rollAttr" attrName=(case "title" attribute)}}}
      {{/if}}
		</span>
	</div>

  {{#if sourceName}}
	<div class="roll-source-header">
		<span class="roll-source-name">
      {{> "systems/kult4th/templates/components/icon.hbs"
        icon=sourceImg
        type=sourceType
        name=sourceName
        isChat=true
      }}
      <span class="roll-source-text">{{sourceName}}</span>
    </span>
    {{#if source.system.parentItem}}{{#if source.system.parentItem.name}}
      <span class="roll-source-source-name">
        from <span class="roll-source-text">{{source.system.parentItem.name}}</span>
      </span>
    {{/if}}{{/if}}
	</div>
  {{/if}}

	<div class="roll-dice-line">
		<div class="roll-term-container roll-d10">
			<img src="systems/kult4th/assets/icons/roll-terms/ten-sided-die.svg" />
			<span class="roll-d10-value">{{dice.[0]}}</span>
		</div>
		{{#unless (eq attribute "zero")}}
		<div class="roll-term-container attribute-{{attribute}}">
			<img src="systems/kult4th/assets/icons/roll-terms/{{attribute}}.svg" />
			<span class="roll-d10-value" data-attrVal="{{attrVal}}">{{signNum attrVal}}</span>
		</div>
		{{/unless}}
		<div class="roll-term-container roll-d10">
			<img src="systems/kult4th/assets/icons/roll-terms/ten-sided-die.svg" />
			<span class="roll-d10-value">{{dice.[1]}}</span>
		</div>
	</div>

	<div class="roll-dice-results">
			<div class="roll-total {{~#if (gte total 20)}} narrow{{/if}}">
				<span class="roll-total-gear">
					<img class="gear-chagidiel-inner-ring" src="systems/kult4th/assets/gears/gear-chagidiel-inner-ring.svg">
					<img class="gear-chagidiel-middle-ring" src="systems/kult4th/assets/gears/gear-chagidiel-middle-ring.svg">
					<img class="gear-chagidiel-outer-ring" src="systems/kult4th/assets/gears/gear-chagidiel-outer-ring.svg">
				</span>
				<span class="roll-total-number">{{total}}</span>
			</div>
			<div class="roll-modifiers">
				{{#each modifiers}}
				<div class="roll-mod roll-mod-{{#if (test value ">=" 0)}}pos{{else}}neg{{/if}}">
					<span class="roll-mod-val">{{signNum value}}</span>
					<span class="roll-mod-desc">({{name}})</span>
				</div>
				{{/each}}
			</div>
			{{#if (gte total 15)}}
			<span class="roll-outcome-main">{{localize "kult4th.roll.success"}}</span>
			{{else}}{{#if (gte total 10)}}
			<span class="roll-outcome-main">{{localize "kult4th.roll.success"}}</span>
			<span class="roll-outcome-sub">{{localize "kult4th.roll.withComplications"}}</span>
			{{else}}
			<span class="roll-outcome-main">{{localize "kult4th.roll.failure"}}</span>
			{{/if}}{{/if}}
	</div>

	{{> "systems/kult4th/templates/components/roll-result.hbs" type="active-rolled" diceRange="" result=result context=source}}

	{{~#if result.listRefs}}
		{{> "systems/kult4th/templates/components/item-list.hbs" lists=source.system.lists listRefs=result.listRefs type=source.type isDisplayingName=true}}
	{{/if}}

</div>